define job load_ventes3_from_csv
description 'Load ventes3.csv to the Vente table'
(
    define schema ventes_schema
    (
        LocID       varchar(30),
        TPVID       varchar(30),
        TkNum       varchar(30),
        TkDT        varchar(30),
        TkHR        varchar(30),
        VisID       varchar(30),
        VisTypeCD   varchar(30),
        CliID       varchar(30),
        CliStatCD   varchar(30),
        TklNetAmt   varchar(30),
        Qty         varchar(30),
        Mesure      varchar(30),
        ItemID      varchar(30),
        RemAmt      varchar(30)
    );

    define operator file_reader
    type dataconnector producer
    schema ventes_schema
    attributes
    (
        varchar FileName = 'ventes3.csv',
        varchar Format = 'delimited',
        varchar TextDelimiter = ';'
    );

    define operator load_ventes3
    type load
    schema ventes_schema
    attributes
    (
        varchar UserName = 'dbc',
        varchar UserPassword = 'dbc',
        varchar TargetTable = 'PRDW.Vente',
        varchar LogTable = 'PRDW.Log_Ventes'
    );

    apply ('insert into PRDW.Vente(
            LocID, TPVID, TkNum, TkDT, TkHR, VisID, VisTypeCD, CliID, CliStatCD,
            TklNetAmt, Qty, Mesure, ItemID, RemAmt)
        values (:locid, :tpvid, :tknum, :tkdt, :tkhr, :visid, :vistypecd,
                :cliid, :clistatcd, :tklnetamt, :qty, :mesure, :itemid,
                :remamt);')
    to operator (load_ventes3[1])

    select LocID, TPVID, TkNum, TkDT, TkHR, VisID, VisTypeCD, CliID, CliStatCD,
        TklNetAmt, Qty, Mesure, ItemID, RemAmt
    from operator (file_reader[1]);
);
